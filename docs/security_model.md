# Threat model and Assurance Case

This document consolidates the threat model, secure design rationale, and assurance arguments for `github.com/bytemare/{{.template}}`.
It explains how the library resists misuse and where residual risks remain.

## 1. Threat Model

### 1.1 Assets

- [ASSET_1]: [DESCRIPTION]
- [ASSET_2]: [DESCRIPTION]
- [ASSET_3]: [DESCRIPTION]

### 1.2 Trust Boundaries

1. **Caller → Public API**: [WHAT_CROSSES]
2. **Public API → Internal**: [WHAT_CROSSES]
3. **Internal → Backends**: [WHAT_CROSSES]

### 1.3 STRIDE Analysis

| Component   | Threat                    | Mechanism | Likelihood   | Impact       | Risk         | Mitigations  |
|-------------|---------------------------|-----------|--------------|--------------|--------------|--------------|
| [COMPONENT] | Spoofing                  | [HOW]     | Low/Med/High | Low/Med/High | Low/Med/High | [MITIGATION] |
| [COMPONENT] | Tampering                 | [HOW]     |              |              |              | [MITIGATION] |
| [COMPONENT] | Repudiation               | [HOW]     |              |              |              | [MITIGATION] |
| [COMPONENT] | Info Disclosure           | [HOW]     |              |              |              | [MITIGATION] |
| [COMPONENT] | Denial of Service         | [HOW]     |              |              |              | [MITIGATION] |
| [COMPONENT] | Elevation of Privilege    | [HOW]     |              |              |              | [MITIGATION] |
| [COMPONENT] | [Add others if necessary] | [HOW]     |              |              |              | [MITIGATION] |

## 2. Assurance Case

High-assurance level: [INDICATE CA LEVEL]

**Claims**: [List all claims and provide proof].

- **Design**: [ARGUMENT]
- **Implementation**: [ARGUMENT]
- **Operational**: [ARGUMENT]

## 3. Secure Design Principles

| Principle                 | Applied?           | Notes         |
|---------------------------|--------------------|---------------|
| Fail-safe defaults        | Yes/No/Partial/N/A | [HOW_APPLIED] |
| Input validation          | Yes/No/Partial/N/A | [HOW_APPLIED] |
| Least privilege           | Yes/No/Partial/N/A | [HOW_APPLIED] |
| Defense in depth          | Yes/No/Partial/N/A | [HOW_APPLIED] |
| Separation of duties      | Yes/No/Partial/N/A | [HOW_APPLIED] |
| Economy of mechanism      | Yes/No/Partial/N/A | [HOW_APPLIED] |
| Secure defaults           | Yes/No/Partial/N/A | [HOW_APPLIED] |
| Auditability              | Yes/No/Partial/N/A | [HOW_APPLIED] |
| [Add others if necessary] | [COUNTERMEASURE]   |

Principles not yet fully addressed (e.g., separation of duties) are tracked on the [roadmap](roadmap.md) for future governance enhancements.

### Pipeline Security

- The code base is managed, retained, version controlled, and archived through GitHub.
- Required signed commits and tags for verified history.
- Pull requests require at least one maintainer review.
- CI runs on every commit and pull request, requiring status checks to pass before merging, including tests, coverage, linting, SAST.

#### Release properties
- Releases are tagged with Semantic Versioning (SemVer) tags.
- Release artifacts include source tarballs, CycloneDX SBOMs, and SLSA provenance attestations.
- Release signatures are generated using SSH/GPG and attached to GitHub releases.
- Release artifact bundling is scripted and configured as code to run in isolated and ephemeral GitHub Actions containers.
- Releases can be reproduced hermetically and without parameters.

#### Provenance
- Provenance attestations follow the in-toto specification and include builder identity, build type, invocation parameters, materials, and list all dependencies through the SBOM.
- Provenance is attached to GitHub releases as `.intoto.jsonl` assets.
- Provenance is generated by GitHub Actions and signed using Sigstore and stored in the Rekor transparency log.

## 4. Common Weakness Coverage

| Weakness                   | Countermeasures  |
|----------------------------|------------------|
| Invalid/malformed input    | [COUNTERMEASURE] |
| Insecure randomness        | [COUNTERMEASURE] |
| Side-channel leakage       | [COUNTERMEASURE] |
| Dependency vulnerabilities | [COUNTERMEASURE] |
| [Add others if necessary]  | [COUNTERMEASURE] |

## 5. Residual Risks and Assumptions

- [RISK_1]
- [RISK_2]
- [ASSUMPTION_1]

## 6. Reporting and Incident Handling

For security vulnerabilities, follow [SECURITY.md](../.github/SECURITY.md).

---

Update this document when adding new functionality.
